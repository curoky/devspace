#!/usr/bin/env bash
set -xeuo pipefail

script_path="$(readlink -f "$0")"
root=$(cd "$(dirname "$script_path")" && pwd)

export CONTAINERS_CONF=$root/../conf/containers.conf
export CONTAINERS_STORAGE_CONF=$root/../conf/storage.conf
export CONTAINERS_REGISTRIES_CONF=$root/../conf/registries.conf
# export CONTAINERS_POLICY=$root/../conf/policy.json

# export CONTAINER_HOST=unix:///tmp/mypodman.sock

# or --tmpdir=path
# export TMPDIR=$root/tmpdir

# or helper_binaries_dir/--network-cmd-path
export PATH=$PATH:$root
export LD_LIBRARY_PATH=$root/../lib

# --imagestore=$root/storage \
# --runroot=$root/runroot \
# --network-cmd-path=$root/bin \
# --log-level=debug \
exec -a "$0" "$root/_podman" \
  --out=$root/../podman.log \
  "$@"
